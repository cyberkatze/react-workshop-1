<!DOCTYPE html>
<html>
  <head>
    <title>React JS Workshop</title>
    <link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap.min.css">
    <script src="react.js"></script>
    <script src="JSXTransformer.js"></script>
  </head>
  <body>
    <script type="text/jsx">
      /** @jsx React.DOM */

      var Calculator = React.createClass({
        getInitialState: function(){
          return {
            items: [
              {id: 1, name: "MacBook Air", date: "14.07.2014", amount: -20000}
            ]
          };
        },
        render: function(){
          return(
            <div className="container">
              <h1>Калькулятор</h1>
              <div className="panel panel-default">
                <div className="panel-body">
                  <InputForm addItem={this.handleAdd} />
                </div>
              </div>

              <Table items={this.state.items} />
            </div>
          );
        }
      });

      var Table = React.createClass({
        render: function(){
          var total = 0;

          var rows = this.props.items.map(function(item){
            total += item.amount;
            return <TableRow key={item.id} name={item.name} date={item.date} amount={item.amount} />
          });

          return(
            <table className="table table-bordered">
              <thead>
                <tr key="head">
                  <th>Название</th>
                  <th>Дата</th>
                  <th>Деньги</th>
                </tr>
              </thead>

              <tbody>
                {rows}

                <tr className="info" key="total">
                  <th>Итого</th>
                  <th></th>
                  <th>{total}</th>
                </tr>
              </tbody>
            </table>
          );
        }
      });

      var TableRow = React.createClass({
        render: function() {
          return(
            <tr>
              <td>{this.props.name}</td>
              <td>{this.props.date}</td>
              <td>{this.props.amount}</td>
            </tr>
          );
        }
      });

      var InputForm = React.createClass({
        getInitialState: function() {
          return {name: "", date: "", amount: ""}
        },
        render: function() {
          return(
            <form className="form-inline" onSubmit={this.handleSubmit} role="form">
              <div className="form-group">
                <input className="form-control" 
                       type="text" 
                       name="name" 
                       placeholder="Name"
                       value={this.state.name} />
              </div>
              <div className="form-group">
                <input className="form-control" 
                       type="text" 
                       name="date" 
                       value={this.state.date} 
                       placeholder="Date" />
              </div>
              <div className="form-group">
              <input className="form-control" 
                     type="text" 
                     name="amount" 
                     value={this.state.amount} 
                     placeholder="Amount" />
              </div>

              <button className="btn btn-primary">Add</button>
            </form>
          );
        }
      });

      React.renderComponent(
        <Calculator />,
        document.body
      );
    </script>

  </body>
</html>
